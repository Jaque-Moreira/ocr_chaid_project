View(dados_long)
# Carregando extra칞칚o dos dados OCR em formato de tabela longa
# ==========================
dados_long <- read.csv2(
here("ocr-chaid-project","data", "mock_data_base_for_CHAID.csv"),
header = TRUE,
sep = ";"
)
# Convertendo tabela em formato wide (alternativas como colunas)
# ==========================
dados <- as.data.frame(lapply(dados_long %>%
select(sala, pagina, alternativa, marcada) %>%
pivot_wider(
names_from  = alternativa,
values_from = marcada,
values_fill = 0
), as.factor))
dados <- read.csv2(
here("ocr-chaid-project","data", "mock_data_base_for_CHAID"),
header = TRUE,
sep = ","
)
dados <- read.csv2(
here("ocr-chaid-project","data", "mock_data_base_for_CHAID.csv"),
header = TRUE,
sep = ","
)
dados <- dados %>%
mutate(X6 = case_when(
X6a == "1" ~ "a",
X6b == "1" ~ "b"))
dados <- as.data.frame(lapply(read.csv2(
here("ocr-chaid-project","data", "mock_data_base_for_CHAID.csv"),
header = TRUE,
sep = ","
),as.factor))
dados <- dados %>%
mutate(X6 = case_when(
X6a == "1" ~ "a",
X6b == "1" ~ "b"))
dados
dados <- as.data.frame(lapply(read.csv2(
here("ocr-chaid-project","data", "mock_data_base_for_CHAID.csv"),
header = TRUE,
sep = ";"
),as.factor))
dados <- dados %>%
mutate(X6 = case_when(
X6a == "1" ~ "a",
X6b == "1" ~ "b"))
dados <- dados %>% select(,-"X6a",-"X6b")
dados <- as.data.frame(lapply(dados, as.factor))
head(dados)
autolesao = dados %>% filter(X4e == 1)
# autolesao =  data.frame(
#   alternativa = names(autolesao %>% select(,-sala,-pagina)),
#   qtd_marcada = as.numeric(colSums(autolesao %>% select(,-sala,-pagina) == 1, na.rm = TRUE)))
# autolesao %>% filter(X6 == "a") %>% select(sala,pagina,X4e)
autolesao_q1 <- data.frame(
alternativa = names(autolesao %>% select(X1a,X1b,X1c,X1d,X1e,X1f,X1g)),
qtd_marcada = as.numeric(colSums(autolesao %>% select(X1a,X1b,X1c,X1d,X1e,X1f,X1g) == 1, na.rm = TRUE))
)
autolesao_q1 <- autolesao_q1 %>% mutate(alternativa = case_when(
alternativa == "X1a" ~ "1a - Press칚o social",
alternativa == "X1b" ~ "1b - Problemas de auto estima",
alternativa == "X1c" ~ "1c - Sa칰de mental",
alternativa == "X1d" ~ "1d - Problemas familiares",
alternativa == "X1e" ~ "1e - Problemas escolares",
alternativa == "X1f" ~ "1f - Dificuldade de identidade",
alternativa == "X1g" ~ "1g - Outro"))
autolesao_q1_outro = autolesao %>% filter(X1g == 1) %>% select(sala,pagina, X6)
autolesao_q1_outro
autolesao_q1_plot <- autolesao_q1 %>% ggplot(mapping = (aes(x=str_wrap(alternativa, width = 10),
y = qtd_marcada))) +
# Construindo gr치ficos
geom_col(fill = "#002952") +
# definindo Titulos
labs(title = "AUTOLES츾O - Quest칚o 1",
subtitle = "O que eu acho mais dificil em ser um adolescente",
y = "qtd de alunos que assinalaram",
x= "Alternativas") +
# label
geom_text(aes(label = qtd_marcada), position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
scale_y_continuous(breaks=seq(0,23,2)) +
ylim(0, 23) +
# alterando aparecia
theme_classic( base_family = "montserrat")+
theme(# titles
plot.title = element_text(hjust = 0.5, size=14, face="bold"),
axis.title.x = element_text(size=8, hjust = 0.9, face = "bold"),
axis.title.y = element_text(size=8, hjust = 0.9, face = "bold", angle = 90),
legend.title = element_text(size=10, face = "italic"),
plot.subtitle = element_text(hjust = 0.5, size=11),
#legend
legend.position="none",
legend.text = element_text(size=10),
#axis
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=10),
#axis.line = element_line(color = "black", size = 1, linetype = 1))
#grid
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "#D1D1D1", size = 0.3, linetype = 2),
# Alterar a cor de fundo do gr치fico completo (incluindo margens e t칤tulos)
plot.background = element_rect(fill = "#F6F6F7"),
# Alterar a cor de fundo do painel (치rea de plotagem)
panel.background = element_rect(fill = "#F6F6F7"))
autolesao_q1_plot
autolesao_q2 <- data.frame(
alternativa = names(autolesao %>% select(X2a,X2b,X2c,X2d,X2e,X2f)),
qtd_marcada = as.numeric(colSums(autolesao %>% select(X2a,X2b,X2c,X2d,X2e,X2f) == 1, na.rm = TRUE))
)
autolesao_q2 <- autolesao_q2 %>% mutate(alternativa = case_when(
alternativa == "X2a" ~ "Tens칚o muscular",
alternativa == "X2b" ~ "Dor de Cabe칞a",
alternativa == "X2c" ~ "Dificuldade para respirar",
alternativa == "X2d" ~ "Ins칪nia",
alternativa == "X2e" ~ "Cora칞칚o acelerado",
alternativa == "X2f" ~ "Outra sensa칞칚o"))
autolesao_q2_outro = autolesao %>% filter(X2f == 1) %>% select(sala,pagina, X6)
autolesao_q2_outro
autolesao_q2_plot <- autolesao_q2 %>% ggplot(mapping = (aes(x=str_wrap(alternativa, width = 10),
y = qtd_marcada))) +
# Construindo gr치ficos
geom_col(fill = "#002952") +
# definindo Titulos
labs(title = "AUTOLES츾O - Quest칚o 2",
subtitle = "Como meu corpo mostra que algo n칚o est치 bem com as minhas emo칞칫es?",
y = "qtd de alunos que assinalaram",
x= "Alternativas") +
# label
geom_text(aes(label = qtd_marcada), position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
scale_y_continuous(breaks=seq(0,23,2)) +
ylim(0, 23) +
# alterando aparecia
theme_classic( base_family = "montserrat")+
theme(# titles
plot.title = element_text(hjust = 0.5, size=14, face="bold"),
axis.title.x = element_text(size=8, hjust = 0.9, face = "bold"),
axis.title.y = element_text(size=8, hjust = 0.9, face = "bold", angle = 90),
legend.title = element_text(size=10, face = "italic"),
plot.subtitle = element_text(hjust = 0.5, size=11),
#legend
legend.position="none",
legend.text = element_text(size=10),
#axis
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=10),
#axis.line = element_line(color = "black", size = 1, linetype = 1))
#grid
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "#D1D1D1", size = 0.3, linetype = 2),
# Alterar a cor de fundo do gr치fico completo (incluindo margens e t칤tulos)
plot.background = element_rect(fill = "#F6F6F7"),
# Alterar a cor de fundo do painel (치rea de plotagem)
panel.background = element_rect(fill = "#F6F6F7"))
autolesao_q2_plot
autolesao_q3 <- data.frame(
alternativa = names(autolesao %>% select(X3a,X3b,X3c)),
qtd_marcada = as.numeric(colSums(autolesao %>% select(X3a,X3b,X3c) == 1, na.rm = TRUE)
))
autolesao_q4 <- data.frame(
alternativa = names(autolesao %>% select(X4a,X4b,X4c,X4d,X4e,X4f)),
qtd_marcada = as.numeric(colSums(autolesao %>% select(X4a,X4b,X4c,X4d,X4e,X4f) == 1, na.rm = TRUE)
))
autolesao_q4_outro = autolesao %>% filter(X4f == 1) %>% select(sala,pagina, X6)
autolesao_q4_outro
autolesao_q5 = autolesao %>% select(sala,pagina)
autolesao_q5
autolesao_df <- dados %>% filter(X4e == 1) %>%
mutate(
across(
.cols = !c(sala,X6),  # O operador '!' (n칚o) exclui a coluna especificada
.fns = ~as.numeric(as.character(.x)) # A fun칞칚o a ser aplicada
),
sintomas = as.numeric(X2a+X2b+X2c+X2d+X2e+X2f))
summary(factor(autolesao_df$sintomas))
autolesao_q2_plot <- autolesao_q2 %>% ggplot(mapping = (aes(x=alternativa, y = qtd_marcada))) +
# Construindo gr치ficos
geom_col(fill = "#002952") +
# definindo Titulos
labs(title = "AUTOLES츾O - Quest칚o 2",
subtitle = "XXXXXXXXXXXXXXXXXX",
y = "qtd de alunos que assinalaram",
x= "alternativas") +
geom_text(aes(label = qtd_marcada), position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
ylim(0, 23) +
# alterando aparecia
theme_classic()+
theme(# titles
plot.title = element_text(hjust = 0.5, size=14, face="bold"),
axis.title.x = element_text(size=10, hjust = 0.9, face = "bold"),
axis.title.y = element_text(size=10, hjust = 0.9, face = "bold", angle = 90),
legend.title = element_text(size=10, face = "italic"),
plot.subtitle = element_text(hjust = 0.5, size=11),
#legend
legend.position="none",
legend.text = element_text(size=10),
#axis
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10),
#axis.line = element_line(color = "black", size = 1, linetype = 1))
#grid
panel.grid.major = element_line(color = "grey", linewidth = 0.5, linetype = 2))
#panel.grid.major.y = element_line(color = "grey", size = 0.5, linetype = 2))
autolesao_q2_plot
chaid_df = dados
chaid_df <- chaid_df %>% mutate(X1a = "Press칚o social")
chaid_model <-chaid(X4e ~ .,
data = dados)
plot(chaid_model)
png("CHAID.png", width = 4000, height = 2000, res = 300)
chaid_plot = plot(
chaid_model,cex = 0.7,
terminal_panel = node_barplot(chaid_model,
text = c("vertical"),
just = c("top"),gp = gpar(fontsize = 14)),
inner_panel = node_inner,
tp_args = list(gp = grid::gpar(fontsize = 14)),
gp = grid::gpar(fontsize = 14)
)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size = 2),
panel.background = element_rect(fill = "red")) # <-- Linha adicionada
dev.off()
# APLICAR UMA MESMA FUN칂츾O A TODAS AS COLUNAS DO DATA FRAME COM EXCE칂칏ES
atencao_df <- dados %>%
mutate(
across(
.cols = !c(sala,X6),  # O operador '!' (n칚o) exclui a coluna especificada
.fns = ~as.numeric(as.character(.x)) # A fun칞칚o a ser aplicada
),
sintomas = as.numeric(X2a+X2b+X2c+X2d+X2e+X2f))
atencao = atencao_df %>% filter(sintomas>=3 & X4e == 0)
summary(atencao %>% select(X6)) # para dataframes de factors
# teste_summary <- as.data.frame(lapply(atencao %>% select(sintomas), as.factor))
#
# summary(teste_summary,maxsum = 50)
teste_summary <- as.data.frame(lapply(atencao %>% select(X4a,X4b,X4c,X4d,X4e,X4f), as.factor))
summary(teste_summary,maxsum = 50)
summary(as.factor(atencao %>% select(X1a,X1b,X1c,X1d,X1e,X1f,X1g)), maxsum = 50)
autolesao_q1_plot <- autolesao_q1 %>% ggplot(mapping = (aes(x=str_wrap(alternativa, width = 10),
y = qtd_marcada))) +
# Construindo gr치ficos
geom_col(fill = "#002952") +
# definindo Titulos
labs(title = "AUTOLES츾O - Quest칚o 1",
subtitle = "O que eu acho mais dificil em ser um adolescente",
y = "qtd de alunos que assinalaram",
x= "Alternativas") +
# label
geom_text(aes(label = qtd_marcada), position = position_dodge(width = 0.9), vjust = -0.5, size = 3) +
scale_y_continuous(breaks=seq(0,23,2)) +
ylim(0, 23) +
# alterando aparecia
theme_classic( base_family = "montserrat")+
theme(# titles
plot.title = element_text(hjust = 0.5, size=14, face="bold"),
axis.title.x = element_text(size=8, hjust = 0.9, face = "bold"),
axis.title.y = element_text(size=8, hjust = 0.9, face = "bold", angle = 90),
legend.title = element_text(size=10, face = "italic"),
plot.subtitle = element_text(hjust = 0.5, size=11),
#legend
legend.position="none",
legend.text = element_text(size=10),
#axis
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=10),
#axis.line = element_line(color = "black", size = 1, linetype = 1))
#grid
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "#D1D1D1", size = 0.3, linetype = 2),
# Alterar a cor de fundo do gr치fico completo (incluindo margens e t칤tulos)
plot.background = element_rect(fill = "#F6F6F7"),
# Alterar a cor de fundo do painel (치rea de plotagem)
panel.background = element_rect(fill = "#F6F6F7"))
autolesao_q1_plot
chaid_df = dados
chaid_df <- chaid_df %>% mutate(X1a = "Press칚o social")
chaid_model <-chaid(X4e ~ .,
data = dados)
plot(chaid_model)
png("CHAID.png", width = 4000, height = 2000, res = 300)
chaid_plot = plot(
chaid_model,cex = 0.7,
terminal_panel = node_barplot(chaid_model,
text = c("vertical"),
just = c("top"),gp = gpar(fontsize = 14)),
inner_panel = node_inner,
tp_args = list(gp = grid::gpar(fontsize = 14)),
gp = grid::gpar(fontsize = 14)
)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size = 2),
panel.background = element_rect(fill = "red")) # <-- Linha adicionada
dev.off()
png("CHAID.png", width = 4000, height = 2000, res = 300)
chaid_plot = plot(
chaid_model,cex = 0.7,
terminal_panel = node_barplot(chaid_model,
text = c("vertical"),
just = c("top"),gp = gpar(fontsize = 14)),
inner_panel = node_inner,
tp_args = list(gp = grid::gpar(fontsize = 14)),
gp = grid::gpar(fontsize = 14)
)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size = 2),
panel.background = element_rect(fill = "red")) # <-- Linha adicionada
dev.off()
chaid_control(alpha2 = 0.05, alpha3 = -1, alpha4 = 0.05,
minsplit = 5, minbucket = 7, minprob = 0.01,
stump = FALSE, maxheight = -1)
chaid_model <-chaid(X4e ~ .,
data = dados)
plot(chaid_model)
chaid_control(alpha2 = 0.05, alpha3 = -1, alpha4 = 0.10,
minsplit = 5, minbucket = 7, minprob = 0.01,
stump = FALSE, maxheight = -1)
chaid_model <-chaid(X4e ~ .,
data = dados)
plot(chaid_model)
ctrl<- (alpha2 = 0.05, alpha3 = -1, alpha4 = 0.10,
ctrl<- (alpha2 = 0.05, alpha3 = -1, alpha4 = 0.10, minsplit = 5, minbucket = 7, minprob = 0.01, stump = FALSE, maxheight = -1)
# definindo parametros da Analise CHAID
# alterar os valores conforme necessidade
ctrl <- chaid_control (alpha2 = 0.05, alpha3 = -1, alpha4 = 0.10, minsplit = 30, minbucket = 7, minprob = 0.01, stump = FALSE, maxheight = -1)
# rodando modelo CHAID
chaid_model <-chaid(X4e ~ .,
data = dados, control = ctrl)
plot(chaid_model)
# definindo parametros da Analise CHAID
# alterar os valores conforme necessidade
ctrl <- chaid_control (alpha2 = 0.05, alpha3 = -1, alpha4 = 0.10, minsplit = 20, minbucket = 7, minprob = 0.01, stump = FALSE, maxheight = -1)
# rodando modelo CHAID
chaid_model <-chaid(X4e ~ .,
data = dados, control = ctrl)
plot(chaid_model)
# definindo parametros da Analise CHAID
# alterar os valores conforme necessidade
ctrl <- chaid_control (alpha2 = 0.10, alpha3 = -1, alpha4 = 0.10, minsplit = 20, minbucket = 7, minprob = 0.01, stump = FALSE, maxheight = -1)
# rodando modelo CHAID
chaid_model <-chaid(X4e ~ .,
data = dados, control = ctrl)
plot(chaid_model)
# definindo parametros da Analise CHAID
# alterar os valores conforme necessidade
ctrl <- chaid_control (alpha2 = 0.05, alpha3 = -1, alpha4 = 0.10, minsplit = 20, minbucket = 7, minprob = 0.01, stump = FALSE, maxheight = -1)
# rodando modelo CHAID
chaid_model <-chaid(X4e ~ .,
data = dados, control = ctrl)
plot(chaid_model)
# salvar diagrama como imagem
png(filename = here("outcome", "CHAID.png"), width = 4000, height = 2000, res = 300)
png("teste.png")
plot(1:10)
dev.off()
# salvar diagrama como imagem
png(filename = here("outcome", "CHAID.png"), width = 4000, height = 2000, res = 300)
# salvar diagrama como imagem
png(filename = here("ocr-chaid-project","outcome", "CHAID.png"), width = 4000, height = 2000, res = 300)
chaid_plot = plot(
chaid_model,cex = 0.7,
terminal_panel = node_barplot(chaid_model,
text = c("vertical"),
just = c("top"),gp = gpar(fontsize = 14)),
inner_panel = node_inner,
tp_args = list(gp = grid::gpar(fontsize = 14)),
gp = grid::gpar(fontsize = 14)
)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size = 2),
panel.background = element_rect(fill = "red")) # <-- Linha adicionada
dev.off()
git add .
setwd("C:/Users/morei/Documents/Workspace/Ocerizacao/")
setwd("C:/Users/morei/Documents/Workspace/Ocerizacao/")
arquivos <- list.files(
path = "C:/Users/morei/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala",
pattern = "^resultado_final_.*\\.csv$",
full.names = TRUE
)
bd_final <- arquivos %>%
lapply(read_csv2) %>%
bind_rows()
bd_final
arquivos <- list.files(
path = "C:/Users/morei/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala",
pattern = "^resultado_final_.*\\.csv$",
full.names = TRUE
)
arquivos
pasta <- "C:/Users/morei/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala"
# Listar arquivos corretamente
arquivos <- list.files(
path = pasta,
pattern = "^resultado_final_[0-9]+\\.csv$",
full.names = TRUE
)
# 游댍 Verifica칞칚o (PASSO CR칈TICO)
print(arquivos)
library(dplyr)
library(readr)
pasta <- "C:/Users/morei/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala"
# Listar arquivos corretamente
arquivos <- list.files(
path = pasta,
pattern = "^resultado_final_[0-9]+\\.csv$",
full.names = TRUE
)
# 游댍 Verifica칞칚o (PASSO CR칈TICO)
print(arquivos)
pasta
arquivos
list.files(pasta)
pasta <- "C:/Users/morei/OneDrive/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala"
list.files(pasta)
pasta <- "C:/Users/morei/OneDrive/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala"
pasta
list.files(pasta)
dir.exists(pasta)
pasta <- "C:/Users/morei/OneDrive/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala"
dir.exists(pasta)
pasta <- "C:/Users/morei/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala"
dir.exists(pasta)
pasta <- "C:/Users/morei/Documents/Workspace/Ocerizacao/outcome/extracao_por_sala/"
dir.exists(pasta)
pasta <- "C://Users//morei//Documents//Workspace//Ocerizacao//outcome//extracao_por_sala"
dir.exists(pasta)
pasta <- "C://Users//morei//Documents//Workspace//Ocerizacao//outcome//extracao_por_sala"
dir.exists(pasta)
pasta <- "C:\Users\morei\Documents\Workspace\Ocerizacao\outcome\extracao_por_sala"
pasta <- "C:\Users\morei\Documents\Workspace\Ocerizacao\outcome\extracao_por_sala"
pasta <- "C:/Users/morei/OneDrive/Documentos/Workspace/Ocerizacao/outcome/extracao_por_sala"
dir.exists(pasta)
pasta <- "C:/Users/morei/OneDrive/Documentos/Workspace/Ocerizacao/outcome/extracao_por_sala"
# Listar arquivos corretamente
arquivos <- list.files(
path = pasta,
pattern = "^resultado_final_[0-9]+\\.csv$",
full.names = TRUE
)
# 游댍 Verifica칞칚o (PASSO CR칈TICO)
print(arquivos)
list.files(pasta)
arquivos
bd_final <- arquivos %>%
lapply(read_csv2) %>%
bind_rows()
bd_final
View(bd_final)
bd_final<-as.data.frame(bd_final)
bd_final
View(bd_final)
View(bd_final)
View(bd_final)
View(bd_final)
bd_final <- arquivos %>%
lapply(read_csv2(sep = ","))) %>%
class(bd_final )
bd_final <- arquivos %>%
lapply(read_csv) %>%
bind_rows()
bd_final<-as.data.frame(bd_final)
class(bd_final)
bd_final <- arquivos %>%
lapply(read_csv) %>%
bind_rows()
class(bd_final)
View(bd_final)
arquivos
# UNINDO ARQUIVOS CSV EM UM UNICO ARQUIVO.
# ------------------------------------------
pasta <- "C:/Users/morei/OneDrive/Documentos/Workspace/Ocerizacao/outcome/extracao_por_sala"
# Listar arquivos corretamente
arquivos <- list.files(
path = pasta,
pattern = "^resultado_final_[0-9]+\\.csv$",
full.names = TRUE
)
dados_tabela_longa <- arquivos %>%
lapply(read_csv) %>%
bind_rows()
dados_tabela_longa
dados <- as.data.frame(lapply(dados_tabela_longa %>%
select(sala, pagina, alternativa, marcada) %>%
pivot_wider(
names_from  = alternativa,
values_from = marcada,
values_fill = 0
dados
View(dados)
View(dados_tabela_longa)
dados
View(dados)
dados <- dados %>%
mutate(X6 = case_when(
X6a == "1" ~ "a",
X6b == "1" ~ "b"))
View(dados)
dados <- as.data.frame(lapply(dados_tabela_longa %>%
select(sala, pagina, alternativa, marcada) %>%
pivot_wider(
names_from  = alternativa,
values_from = marcada,
values_fill = 0
), as.factor))
dados
View(dados)
dados <- dados %>%
mutate(X6 = case_when(
X6a == "1" ~ "a",
X6b == "1" ~ "b"))
dados <- dados %>% select(,-"X6a",-"X6b")
dados <- as.data.frame(lapply(dados, as.factor))
head(dados)
